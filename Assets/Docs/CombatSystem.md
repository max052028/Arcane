# Combat System Design Document

## ✨ 核心戰鬥理念

以玩家主動輸入的攻擊方向與動作節奏為核心，結合防守反應與資源管理，打造兼具操作性與戰術性的 ARPG 體驗。

---

## ⚔️ 攻擊系統

### ■ 方向性攻擊（Directional Melee Attack）

* 玩家可透過特定鍵位選擇「縱向攻擊」或「橫向攻擊」。
* 攻擊具有攻擊範圍與方向碰撞盒，影響敵方是否中招或被格擋。

### ■ 攻擊動作延遲與動畫

* 每次攻擊皆有預備與後搖時間（可搭配動畫事件觸發碰撞）。
* 不同武器種類影響攻擊速度與範圍。

---

## ⛨️ 格擋系統（Directional Guard）

### ■ 基本邏輯

* 若敵方攻擊方向與玩家格擋方向相反，則視為成功格擋。
* 格擋成功會產生反彈（硬直）與體力消耗。
* 格擋失敗視為命中，玩家受傷並中斷行動。

### ■ 高級邏輯（可擴充）

* 完美格擋：於攻擊接觸瞬間格擋，可反擊或減少體力消耗。
* 重攻擊穿透格擋：高強度攻擊將擊破防禦。

---

## ❤️ 體力系統 (Stamina System)

### ■ 消耗行為

* 跑步
* 跳躍
* 攻擊
* 格擋
* 關鍵行動 (e.g. 閃避, 劍欄)

### ■ 恢復機制

* 穩定恢復: 開始 2 秒未動作後每秒回復 X%
* 或製作功能性料理 / 雞腿等不同恢復類道

### ■ 範圍

* 主角和敵方都有體力值
* 體力耗盡時無法攻擊 / 格擋 / 閃避

---

## 🏋️️ HUD 顯示

* 體力條: 黏身在行為列邊位置
* 攻擊模式: UI按鈕切換、提示往線
* 格擋後機: 顯示有效或失敗的回饋

---

## ✨ 可擴充功能 (WIP)

* 劍欄模式 (體力和輕重互動)
* 創價壓力 / 造傷系統 (重擊 / 持續傷害)
* 傷害帶得特效 (燃燒 / 麻痺)
* AI 格擋與開攻策略

---

## ⌚ 開發順序推薦

1. 執行基礎攻擊與環境確認 (Hitbox, Raycast)
2. 實製攻擊動作與方向輸入分析
3. 格擋評估與體力耗盡進入"Break" 狀態
4. 加入敵人AI與格擋機制驗證

---

## 📄 有關 Combat 的 Script 文件組

* `PlayerCombatController.cs` - 攻擊模式 / 體力 / 格擋
* `MeleeAttackHandler.cs` - 效果與碰擊檢測
* `StaminaSystem.cs` - 體力使用和恢復統一管理
* `EnemyCombatAI.cs` - 故作挑選 / 攻擊說明 / 格擋回應

---

## 📁 資料與組件

* `SO/WeaponType/` - 刀劍 / 槍棍 / 裝備配置
* `SO/AttackPattern/` - 連擊技 / 重擊 / 快攻模板
* `AnimEvents/` - 連動動作與碰擊核定範圍

---

## ★ 未來可考慮

* 主動與被動格擋動作的解析
* 動作 cancel window / chain window 設計
* 能量值、經驗值與技能增長等RPG組合
