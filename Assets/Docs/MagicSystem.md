# MagicSystem.md - 魔法系統設計文件

## 本文目的

詳細說明魔法系統的使用模型，含等級設計、組合觀念、設計細節與碼組建議，以於後續実作與執行。

---

## 一、基礎概念

### 1.1 魔法組合模型

* 魔法不是單一種符文，而是由「多個符文組合」而成為一個有效魔法。
* 一個有效的魔法必須包含下列兩類符文：

  * **元素符**：水、火、風、土……決定魔法的屬性與性質。
  * **行為符**：發射、爆炸、創造、持續……決定魔法的行為方式。
* 以下兩類符文為**修飾性質**，可選用以變化魔法表現，但並非所有魔法皆支援：

  * **數值符**：如效果強度（大/小）、作用區域（自身/定點/指向/追蹤/鎖定）等調整數值設定。
  * **特性符**：如緊繃、輕量化、類改造器等，影響特殊屬性或兼容性行為。

### 1.2 符文認識

* 每個符文綁定至一個鍵盤按鍵輸入，在施法時輸入鍵對應符文。
* 玩家施放過的魔法會被記錄，並可於 UI 中檢閱符文組合結構。
* 符文經過合理組合後解析為「SpellInstruction」。
* 部分魔法需透過劇情、任務、特定事件學得，部分魔法可自由探索組合發現。

### 1.3 符文組合與驗證

* 所有符文排列順序有所限，可解釋為 AST 組合線栖。
* 有一套驗證正確的符文模型從 ScriptableObject 引用。
* 魔法必須包含元素符與行為符才可成立。
* 數值符與特性符為選用修飾符，並非所有魔法接受修飾，設計上作為平衡調整依據。

---

## 二、法術施放模式

### 2.1 鍵盤輸入施法模式

* 玩家按下施法鍵後進入「繪製模式」，使用鍵盤輸入對應符文。
* 每個鍵盤按鍵對應一個符文，依照輸入順序記錄。
* 玩家再次按下施法鍵則結算並解析魔法。
* 每次施法最大時間：10 秒，超過則自動終止。
* 符文精準度改為輸入比對結果（或後期加入模糊允許）。

### 2.2 符紙

* 預先繪好的符文組合，儲存在遞令物中。
* 魔法發動時快速讀取。
* 無需重新輸入，但效果決定於創建時精準度。
* 符紙只能儲存「符文」而非邏輯順序，屬於中速施法手段。

### 2.3 實體法陣

* 符文作為元件裝設於場景物體中。
* 包含能量源、符文邏輯閘、輸出控制器等模組。
* 可建構大型連鎖魔法結構。
* 若將整體放入可攜載體，可作為可重用的法陣模板。

---

## 三、建議組件 / 類別

### 3.1 SpellRune (SO)

* ID
* 符文類型（元素、行為、數值、特性）
* 關聯觀念（可引用好感度、移動狀態、元素補互效果）

### 3.2 SpellTemplate (SO)

* 符文順序列表
* 預設效果系數和觀效
* 可物件化用於符紙

### 3.3 SpellCastResult

* 時間、精準度、不公平值
* 效果觀鏡與操作結果

### 3.4 SpellCastingController

* 接受輸入（鍵盤 / 符紙）
* 解析符文列表
* 確認效果，命令發射

---

## 固定數值 & 設定

| 項目     | 數值            |
| ------ | ------------- |
| 繪製最大時間 | 10 秒          |
| 符文輸入方式 | 鍵盤對應符文        |
| 符文數量上限 | 2\~8 個 / 一次魔法 |

---

## 未來建議

* 把符文系統與 ArcaneCircuit 數據分離出來
* 製作符文輸入映射工具
* 符紙是否可補充或抽離？
* 魔法效果是否可編變化（通過符文更改）
* 是否開放記錄魔法組合與歷史施放紀錄？作為學習與知識系統
